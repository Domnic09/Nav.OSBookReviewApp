@model List<NavOS.Basecode.Services.ServiceModels.GenreViewModel>

@{
    ViewData["Title"] = "Genre List";

    var genreModal = new NavOS.Basecode.Services.ServiceModels.GenreViewModel();
    var colorClasses = new string[] { "green", "yellow", "orange" };
}
<style>
    .card-big-shadow {
        width: 100%;
        position: relative;
        overflow:hidden;
    }

    .coloured-cards .card {
        margin-top: 30px;
    }

    .card[data-radius="none"] {
        border-radius: 0px;
    }

    .card {
        border-radius: 8px;
        box-shadow: 0 2px 2px rgba(204, 197, 185, 0.5);
        background-color: #FFFFFF;
        color: #252422;
        margin-bottom: 20px;
        position: relative;
        z-index: 1;
    }

        .card[data-background="image"] .title,
        .card[data-background="image"] .stats,
        .card[data-background="image"] .category,
        .card[data-background="image"] .description,
        .card[data-background="image"] .content,
        .card[data-background="image"] .card-footer,
        .card[data-background="image"] small,
        .card[data-background="image"] .content a,
        .card[data-background="color"] .title,
        .card[data-background="color"] .stats,
        .card[data-background="color"] .category,
        .card[data-background="color"] .description,
        .card[data-background="color"] .content,
        .card[data-background="color"] .card-footer,
        .card[data-background="color"] small,
        .card[data-background="color"] .content a {
            color: #FFFFFF;
        }

        .card.card-just-text .content {
            padding: 15px 20px;
            height:70px;
        }

        .genre-button-section{
            height: 100px;
        }

        .admin-name-section {
            height: 20px;
        }

        .card .content {
            padding: 20px 20px 10px 20px;
        }

        .card[data-color="blue"] .category {
            color: #7a9e9f;
        }

        .card .category,
        .card .label {
            font-size: 14px;
            margin-bottom: 0px;
        }

    .card-big-shadow:before {
        background-image: url("http://static.tumblr.com/i21wc39/coTmrkw40/shadow.png");
        background-position: center bottom;
        background-repeat: no-repeat;
        background-size: 100% 100%;
        bottom: -12%;
        content: "";
        display: block;
        left: -12%;
        position: absolute;
        right: 0;
        top: 0;
        z-index: 0;
    }

    h4,
    .h4 {
        font-size: 1.5em;
        font-weight: 600;
        line-height: 1.2em;
    }

    h6,
    .h6 {
        font-size: 0.9em;
        font-weight: 600;
        text-transform: uppercase;
    }

    .card .description {
        font-size: 16px;
        color: #66615b;
    }

    .content-card {
        margin-top: 30px;
        height: 100%;
    }

    a:hover,
    a:focus {
        text-decoration: none;
    }

    /*======== COLORS ===========*/
    .card[data-color="green"] {
        background: #D5E5A3;
    }

        .card[data-color="green"] .description {
            color: #506568;
        }

    .card[data-color="yellow"] {
        background: #FFE28C;
    }

        .card[data-color="yellow"] .description {
            color: #60773d;
        }

    .card[data-color="orange"] {
        background: #FF8F5E;
    }

        .card[data-color="orange"] .description {
            color: #b25825;
        }


    .card[data-color="brown"] {
        background: #d6c1ab;
    }

        .card[data-color="brown"] .description {
            color: #75442e;
        }

        .card[data-color="brown"] .category {
            color: #a47e65;
        }

    .card[data-color="purple"] {
        background: #baa9ba;
    }

        .card[data-color="purple"] .description {
            color: #3a283d;
        }

        .card[data-color="purple"] .category {
            color: #5a283d;
        }

    .card[data-color="orange"] {
        background: #ff8f5e;
    }

        .card[data-color="orange"] .description {
            color: #772510;
        }

        .card[data-color="orange"] .category {
            color: #e95e37;
        }

</style>
<div class="container">
    <div style="margin-top: 40px; text-align: right; margin-bottom: 10px">
        <h3><a href="#addGenreModal" data-toggle="modal" style="text-decoration: none; font-weight: bold; color: #FFC119">+ ADD GENRE</a></h3>
    </div>
</div>

<div class="container bootstrap snippets bootdeys">
    <div class="row">
        @for (int i = 0; i < Model.Count; i++)
        {
            var genre = Model[i];
            var colorClass = colorClasses[i % colorClasses.Length];

            <div class="col-md-4 col-sm-6 content-card">
                <div class="card-big-shadow">
                    <div class="card card-just-text" data-background="color" data-color="@colorClass" data-radius="none">
                        <div class="content">
                            <div class="col-md-12">
                                <h4 class="title">
                                    <a href="#" class="text-decoration-none text-dark" data-bs-toggle="modal" data-bs-target="#exampleModal-@i">
                                        @genre.GenreName
                                    </a>
                                </h4>
                            </div>
                        </div>
                        <div class="genre-button-section">                        
                            <div class=" btn-group ms-3">
                                <form asp-controller="Genre" asp-action="EditGenre" method="get">
                                    <input type="hidden" name="Genreid" value="@genre.GenreId" />
                                    <button type="button" class="btn btn-sm btn-outline-dark rounded-2" data-bs-toggle="modal" data-bs-target="#editModal-@i" style="max-width:150px; box-shadow:none;"><i class="bi bi-pencil"></i> Edit Genre</button>
                                </form>
                                <button type="submit" class="btn btn-sm btn-outline-dark mx-3 rounded-2" style="max-width:150px;" onclick="openModalSet('@genre.GenreId','@genre.GenreName')"><i class="bi bi-trash"></i> Delete Genre</button>
                            </div>
                            <div class=" btn-group ms-3 mt-2">
                                <form asp-controller="Genre" asp-action="BooksGenre" method="get">
                                    <input type="hidden" name="genreName" value="@genre.GenreName" />
                                    <button type="submit" class="btn btn-sm btn-dark rounded-2" style="min-width:246px;"><i class="bi bi-book"></i> Explore Book</button>
                                </form>
                            </div>
                        </div>
                    </div> 
                </div>
            </div>
            <!-- Edit Modal -->
            <div class="modal fade" id="editModal-@i" tabindex="-1" aria-labelledby="editModalLabel-@i" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title text-dark fw-bold" id="editModalLabel-@i">Edit Genre</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <!-- Render the partial view for EditGenre.cshtml in the modal body -->
                            @await Html.PartialAsync("EditGenre", genre)
                        </div>
                    </div>
                </div>
            </div>
            <!-- Modal -->
            <div class="modal fade" id="exampleModal-@i" tabindex="-1" aria-labelledby="exampleModalLabel-@i" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title text-dark fw-bold" id="exampleModalLabel-@i">@genre.GenreName</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <span class="text-dark fw-semibold mb-1">Description:</span>
                            <p class="text-dark">@genre.GenreDescription</p>
                            <div class="col-md-12">
                                <div class="row float-start">
                                    <p class="muted text-dark"><span class="fw-semibold text-dark">Added by:</span> @genre.AddedBy</p>
                                    <br>
                                    <p class="muted text-dark"><span class="fw-semibold text-dark">Updated by:</span> @genre.UpdatedBy</p>
                                </div>
                             </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>
<!-- Add Genre Modal -->
<div class="modal fade" id="addGenreModal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            @Html.Partial("AddGenre", genreModal)
        </div>
    </div>
</div>
<!-- Modal Area for deleting genre-->
<div class="w3-modal" id="deleteModal">
    <div class="w3-modal-content w3-animate-top w3-round-xlarge" style="background-color: #212529;width: 40%; margin-top:50px;">
        <div class="w3-container w3-padding-large">
            <p>
                <div class="text-center">
                    <h3 class="w3-center">Are you sure you want to delete</h3>
                    <h3 class="w3-center" id="GenreName"></h3>
                </div>
            </p>
            <div class="row text-center">
                <div id="GenreId" style="display: none"></div>
                <div class="col-md-6">
                    <button class="btn btn-outline-warning" style="width: 200px" onclick="deleteGenre()"><h3>YES</h3></button>
                </div>
                <div class="col-md-6">
                    <button class="btn btn-warning" style="width: 200px" onclick="modal_control('deleteModal','none')"><h3>NO</h3></button>
                </div>
            </div>
        </div>
    </div>
</div>
@section scripts {
    <script>
        // Check for error message and display Toastr notification
        var errorMessage = '@TempData["ErrorMessage"]';
        var successMessage = '@TempData["SuccessMessage"]';

        if (errorMessage) {
            toastr.error(errorMessage);
        }

        if (successMessage) {
            toastr.success(successMessage);
        }

    </script>

    <script src="~/js/genreModal.js"></script>
}
